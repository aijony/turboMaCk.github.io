<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <title>Deep Dive To (Tail) Recursion - 1 Intro</title>
    <link rel="icon" type="image/png" href="../favicon.png" />
    <link href="https://fonts.googleapis.com/css?family=Cabin:400,400i,700,700i|Open+Sans:400,400i,700,700i&amp;subset=latin-ext" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="../css/default.css" />
  </head>
  <body>
    <header class="page-header">
        <nav class="navigation">
            
                <a href="../">Home</a>
                <a href="../archive.html" class="active">B\og</a>
            
        </nav>
    </header>

    <main class="main-container">
      <div class="content">
        <h1>
          Deep Dive To (Tail) Recursion - 1 Intro
          
            <span class="subtitle">Recursion as one (if no the most) of important concepts.</span>
          
        </h1>

        
<div class="tags">
    Posted in: <a href="../tags/functional%20programming.html">functional programming</a>, <a href="../tags/haskell.html">haskell</a>, <a href="../tags/javascript.html">javascript</a>.
</div>

<div class="info">
    Posted on February 12, 2017
    
</div>

<main id="content">
    <p>From time to time someone raises concern about performance of recursive algorithms in some of many conversations I have with my colleagues, friends and folks from local meetup groups. Even though this might seem to be clear to people with certain level of functional programming experience it’s certainly not generally well understood topic. I’ve found that there is a lot of confusion going around and some folks seems to be pretty scared when you pull all that weird terminology right of the box. This is why I still think it’s worth spending some time exploring what recursion and tail recursion really means and how you can use both in practice.</p>
<h2 id="recursion">Recursion</h2>
<p>Recursion can be found in many areas of mathematics and computer science. There are some examples:</p>
<h4 id="shell">Shell</h4>
<pre class="shell"><code>rm -r folder_name
</code></pre>
<p>where <code>-r</code> means apply command <code>rm</code> recursively to all sub files and sub folders.</p>
<h4 id="algorithms">Algorithms</h4>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">length</span>(arr) <span class="op">{</span>
    <span class="cf">if</span> (<span class="op">!</span>arr[<span class="dv">0</span>]) <span class="op">{</span>
        <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span>
    <span class="op">}</span>
    <span class="va">arr</span>.<span class="at">pop</span>()<span class="op">;</span>

    <span class="cf">return</span> <span class="dv">1</span> <span class="op">+</span> <span class="at">length</span>(arr)<span class="op">;</span>
<span class="op">}</span></code></pre></div>
<p>where function contains call to itself.</p>
<p><strong>Note:</strong> <code>length()</code> implementation is just used for demonstration purposes. Please don’t try to use it in real world! There are many problems with the code above. Performance will be really bad and also function will cause mutations in original array which becomes empty after being passed to the function due to <code>pop()</code> call! If you thinking about using something similar in your code base <code>fuckUpLength</code> would be probably better name for such function.</p>
<h4 id="algebraic-data-types">Algebraic Data Types</h4>
<div class="sourceCode"><pre class="sourceCode haskell"><code class="sourceCode haskell"><span class="kw">data</span> <span class="dt">RoseTree</span> a <span class="fu">=</span> <span class="dt">Node</span> a [<span class="dt">RoseTree</span> a]</code></pre></div>
<p>where type definition might be recursive (type containing itself)</p>
<h4 id="sequences">Sequences</h4>
<p>For instance our friend Fibonacci</p>
<p><br /><span class="math display">$$ \begin{align*}
  F_0 &amp;= 0, \\
  F_1 &amp;= 1, \\
  F_n &amp;= F_{n-1} + F_{n-2}
\end{align*}
$$</span><br /></p>
<p>where fibonnaci n is define in terms of fibbonaci n-1 and fibbonaci n-2.</p>
<h4 id="yo-man-i-heard-you-like">Yo man I heard you like…</h4>
<p>Even though these three might seem completely unrelated it’s super important to understand that underlaying concept is same.</p>
<p>Let’s use <code>rm</code> example for instance. This command executes itself for every sub-folder of folder it’s executed. This simple principle allows <code>rm</code> to work with any depth of directories in file system.</p>
<p>More generally <strong>recursion is property of self-reference</strong>. Acronym “GNU” Gnu’s Not Unix is refering to itself (G stays for GNU itself). Therefore we call such acronym <a href="https://en.wikipedia.org/wiki/Recursive_acronym">recursive acronym</a>.</p>
<p>You can have a look at <a href="https://en.wikipedia.org/wiki/Recursion">wikipedia</a> where you can find more in case you’re interested.</p>
<p><img src="http://s2.quickmeme.com/img/a7/a764b1ed93f5fae80373f990de499c79ef0e2b0b3f950cb6b42ed9294de3b947.jpg" /></p>
<h2 id="loops">Loops</h2>
<p>Loops are fairly popular technique used in place of recursion in many programs. It’s quite important to understand that loops are workaround for underlaying recursive nature of program or algorithm. The idea is simple - instead of dealing with function calling itself we loop sequence of “instructions” over data. In some sense loops are just restrictive abstraction over <code>GOTO</code> but core idea stays same. Program checks some condition (like <code>i &lt; arr.length</code>) proceed some instructions, apply some mutation to data it started with (eg. <code>i++</code>) and <code>GOTO</code> condition again to either executes instructions with new state or exists subroutine if condition is not satisfied.</p>
<p>This solves problem with stack overflow - function can’t return (exit) until all its sub-calls (recursive calls) return) and is generally much closer to what we want hardware to do than recursion itself. Let’s rewrite <code>length()</code> implementation from previous examples using loop.</p>
<div class="sourceCode"><pre class="sourceCode javascript"><code class="sourceCode javascript"><span class="kw">function</span> <span class="at">length</span>(arr) <span class="op">{</span>
    <span class="kw">var</span> len <span class="op">=</span> <span class="dv">0</span><span class="op">;</span>
    <span class="cf">while</span>(arr[<span class="dv">0</span>]) <span class="op">{</span>
      len<span class="op">++;</span>
      <span class="va">arr</span>.<span class="at">pop</span>()
    <span class="op">}</span>

    <span class="cf">return</span> len<span class="op">;</span>
<span class="op">}</span></code></pre></div>
<p><strong>Note:</strong> Even this implementation of length is bad. Function still performs mutation on array using <code>pop()</code>. Please do not use such code for anything but learning.</p>
<p>Loops are so widely used technique that many programmers kind of defaults to it. This is probably because most widely used languages derives more or less from C (think about C++, Java, C#, JavaScript…). Anyway I would say this is huge tradeoff. Translating algorithm for machine is hard and when people writing programs starts to think as machine they quite often miss general logic in program (Tend to solves adhock cases here and there instead abstracting concepts to composable pieces). Even it might seem easier to use loops over recursion to most developers it’s definitely not easier when it comes to more complex algorithms or design of large systems.</p>
<p>There are so many things that can go wrong in simple <code>for</code> loop that it’s even not worth trying to list them. Concept of loops also heavily relies on mutations which are hard to deal with especially when concurrency (in multithreaded environment) is involved. This is nothing new. Even imperative languages introduced many concepts to address issues like this like for example <a href="https://en.wikipedia.org/wiki/Iterator">iterators</a> which I’m not really going to cover in this article but you can find tons of material about them on <a href="https://duckduckgo.com/?q=iterator">the internet</a>.</p>
<p>Nevertheless I still think that recursion over power any other concept and should be the thing we defaults to instinctively when thinking about problem.</p>
<p>Even most <a href="https://en.wikipedia.org/wiki/Dynamic_programming">dynamic programming</a> practices often starts with recursive definition and translates that implementation to loop just to gain better performance characteristics later.</p>
<p><strong>Note:</strong> In case you’re interested learning more about dynamic programming I recommend to look at <a href="https://www.youtube.com/watch?v=OQ5jsbhAv_M&amp;list=PLfMspJ0TLR5HRFu2kLh3U4mvStMO8QURm">MIT’s public Introduction to Algorithms</a>.</p>
<p>There is still one issue using technique like dynamic programming in my opinion. Once you optimize code to loops it’s stay that way. This means every time you or anyone else will need to tweak something in you’re code youl’ll need to walk through code you was no able to put down from head in first place. You can imagine this won’t be pleasing experience. Wouldn’t it be nice to have recursive implementation and hand optimization to compiler instead?</p>
<p>Good news folks! There are compilers capable of such optimization out there! The only requirement on your side is to keep your implementation <a href="https://en.wikipedia.org/wiki/Tail_call">tail recursive</a>!</p>
<p>We will look what this mean and how you can use it in next part. Till then let force be with you my friends.</p>
</main>



      </div>
      <div id="footer">
        <a href="https://github.com/turboMaCk/turboMaCk.github.io">Source</a> available under BSD-3-Clause.<br>
        Content is pubished under <a rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a>.<br>
        Proudly powered by <a href="http://jaspervdj.be/hakyll">Hakyll</a>; Theme by Marek Fajkus<br>
        <a href="../rss.xml">RSS 2.0</a> compatible
      </div>
    </main>

    <!-- MathJax is library for displaying math nicely -->
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>

  </body>
</html>
